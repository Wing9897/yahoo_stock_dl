# 股票數據爬取器 GUI

基於 yfinance 的股票數據下載工具，提供兩種圖形用戶界面選擇。

## 📦 版本選擇

### 🔧 Tkinter版本 - `stock_gui_tkinter.py`
- **輕量級** - 使用Python內建GUI庫
- **快速啟動** - 無需額外依賴
- **基本功能** - 包含所有核心功能
- **適用於** - 快速使用或系統資源有限的環境

### 🎨 Qt6版本 - `stock_gui_qt6.py` (推薦)
- **現代化界面** - 美觀的用戶體驗
- **完全可縮放** - 支援任意窗口大小調整
- **智能主題** - 自動跟隨系統深色/淺色模式
- **增強功能** - 菜單欄、設置保存、主題切換
- **適用於** - 日常使用或需要更好體驗的場景

## 🚀 功能特點

### 📊 支援多種時間間隔
- 1分鐘 (1m) - 適用於短期交易分析
- 2分鐘 (2m)
- 5分鐘 (5m)
- 15分鐘 (15m)
- 30分鐘 (30m)
- 1小時 (60m/1h)
- 1天 (1d) - 預設值
- 1週 (1wk)
- 1個月 (1mo)

### 🌍 支援多個股票市場
- **美國** (USD): AAPL, MSFT, GOOGL
- **台灣** (TWD): 2330.TW, 2317.TW
- **香港** (HKD): 0700.HK, 0005.HK
- **日本** (JPY): 7203.T, 6758.T
- **德國** (EUR): SAP.DE, VOW3.DE
- **英國** (GBP): BARC.L, LLOY.L

### 💾 多種輸出格式
- **CSV** - 逗號分隔值，適合 Excel 和其他工具
- **Excel** - .xlsx 格式，支援多工作表
- **SQLite** - 關聯式資料庫，同一個 db 檔案包含多個股票表格

### 🔧 核心功能
- ✅ 多股票同時下載（用逗號分隔）
- ✅ 每隻股票獨立儲存
- ✅ 即時進度條顯示
- ✅ 詳細下載日誌
- ✅ 📅 日曆選擇器（Qt6版本）
- ✅ 可停止/暫停下載
- ✅ 輸出目錄選擇

### 🎨 Qt6版本專屬功能
- ✅ **完全可縮放界面** - 從最小化到全屏
- ✅ **智能主題系統** - 自動跟隨系統主題
- ✅ **🌓 三種主題模式** - 自動/淺色/深色
- ✅ **設置持久化** - 自動保存窗口大小和偏好
- ✅ **專業菜單欄** - 完整的應用程序體驗

## 📋 安裝要求

```bash
pip install -r requirements.txt
```

## 🎯 快速開始

### 運行Tkinter版本（輕量）
```bash
python stock_gui_tkinter.py
```

### 運行Qt6版本（推薦）
```bash
python stock_gui_qt6.py
```

## 📖 使用步驟

1. **選擇版本** - 根據需求選擇合適的版本
2. **設定參數**：
   - 輸入股票代號（多個用逗號分隔）
   - 選擇股票市場
   - 設定時間間隔
   - 📅 選擇日期範圍（Qt6版本有日曆選擇器）
   - 選擇輸出格式和目錄
3. **開始下載** - 點擊「開始下載」按鈕

## 股票代號格式

### 美國股票
直接輸入股票代號：`AAPL, MSFT, GOOGL`

### 台灣股票
需要加上 .TW 後綴：`2330.TW, 2317.TW, 2454.TW`

### 香港股票
需要加上 .HK 後綴：`0700.HK, 0005.HK, 0001.HK`

### 日本股票
需要加上 .T 後綴：`7203.T, 6758.T, 9984.T`

## 輸出檔案說明

### CSV/Excel 格式
每隻股票會產生獨立的檔案：
- `AAPL_data.csv`
- `2330_TW_data.xlsx`

### SQLite 格式
所有股票儲存在同一個資料庫檔案 `stock_data.db` 中：
- 表格名稱：`stock_AAPL`, `stock_2330_TW` 等
- 每個表格包含該股票的所有歷史數據

## 資料欄位

下載的資料包含以下欄位：
- **Date** - 日期（索引）
- **Open** - 開盤價
- **High** - 最高價
- **Low** - 最低價
- **Close** - 收盤價
- **Volume** - 成交量
- **Dividends** - 股息
- **Stock Splits** - 股票分割

## 注意事項

1. **時間間隔限制**：
   - 1分鐘數據僅提供最近30天
   - 較短時間間隔可能受到 Yahoo Finance API 限制

2. **市場時間**：
   - 數據僅在相應市場交易時間內更新
   - 假日和非交易日不會有新數據

3. **網路連線**：
   - 需要穩定的網路連線
   - 大量數據下載可能需要較長時間

4. **檔案權限**：
   - 確保輸出目錄有寫入權限
   - SQLite 檔案需要讀寫權限

## 疑難排解

### 常見錯誤
- **"股票代號不存在"**：檢查代號格式和市場後綴
- **"日期範圍錯誤"**：確保開始日期早於結束日期
- **"輸出目錄不存在"**：選擇有效的輸出目錄

### 效能最佳化
- 避免同時下載過多股票
- 較短時間間隔會增加下載時間
- 使用 SQLite 格式可減少檔案數量